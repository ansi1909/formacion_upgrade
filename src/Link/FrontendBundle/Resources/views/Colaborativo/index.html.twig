{% extends '::'~app.session.get('empresa').plantilla %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .menu{
            width: 60%;
            height: 300px;
        }
        body {
            margin-bottom: 300px;
        }
    </style>
{% endblock %}

{% block clbody %}
    lesson-body
{% endblock %}

{% block header %}
    <nav class="navbar justify-content-between py-0 fixed-top bg-white">
        <div class="logo d-none d-md-block">
            <a class="navbar-brand" href="{{ path('_inicio') }}">
                {% set img_logo = app.session.get('empresa').logo is defined ? app.session.get('empresa').logo is not null and app.session.get('empresa').logo != '' ? uploads~app.session.get('empresa').logo : asset('front/assets/img/logo_formacion.png') : asset('front/assets/img/logo_formacion.png') %}
                <img class="img-fluid py-1" src="{{ img_logo }}" width= "200" alt="logo formación 2.0">
            </a>
        </div>
        <div class="wraper-title-lesson d-flex flex-column align-items-center">
            <h4 class="mt-2 mb-1 color-light-grey" >{{ 'Espacio colaborativo'|trans }}</h4>
            <h6 class="mt-0 color-light-grey" >{{ programa.nombre }}</h6>
        </div>
        <div class="navbar-brand d-flex justify-content-center align-items-center" href="#">
            <div class=" d-flex flex-column ">
                <div class="wrapperDdMenu">
                    <a href="#" class="perfil no-decorate" id="config">
                        {% set img = app.session.get('usuario').foto is defined ? app.session.get('usuario').foto is not null and app.session.get('usuario').foto != '' ? uploads~app.session.get('usuario').foto : asset('front/assets/img/user.svg') : asset('front/assets/img/user.svg') %}
                        <img class="img-fluid mx-auto avatar-img" src="{{img}}" alt="usuario"><span class="material-icons color-light-grey icDown">expand_more</span>
                    </a>
                    <ul class="dropDownMenu">
                        <li class="mark"></li>
                        <a href="{{ path('_usuariop') }}">
                            <li class="opcList">
                                <span>{{ 'Preferencias de usuario'|trans }} <i class="material-icons icMenu">style</i></span>
                            </li>
                        </a>
                        <a href="#" data-toggle="modal" data-target="#modalCs">
                            <li class="opcList markOpc">
                                <span>{{ 'Cerrar sesión'|trans }}<i class="material-icons icMenu">exit_to_app</i></span>
                            </li>
                        </a>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
{% endblock %}

{% block sidemenu %}
    <div id="mainSidenav" class="main-sidenav nav-lesson main-sidenav nav-lesson">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()"><i id="menuArrow" class="arrow mr-2"></i></a>
        <a class="d-flex mt-1 mb-3 text-nowrap" href="{{ path('_programa', { 'programa_id': programa.id }) }}"> <i class="material-icons mr-2 rotate-180">exit_to_app</i>{{ 'Volver al programa'|trans }}</a>

        <ul class="nav justify-content-around mb-3" id="pills-tab" role="tablist">
            <li class="nav-item">
                <a class="nav-link" id="pills-indice-tab" data-toggle="pill" href="#pills-indice" role="tab" aria-controls="pills-home" aria-selected="false">
                     <i class="material-icons">view_list</i>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" id="pills-profile-tab" data-toggle="pill" href="#pills-recursos" role="tab" aria-controls="pills-profile" aria-selected="true">
                    <i class="material-icons">widgets</i>
                </a>
            </li>
        </ul>

        <div class="tab-content menu-lesson" id="pills-tabContent" >
            <div class="tab-pane fade" id="pills-indice" role="tabpanel" aria-labelledby="pills-home-tab">
                <h5 class="text-center mb-3 mt-1 color-light-grey font-normal ">{{ 'Índice'|trans }}</h5>
                <ol id="menu_indice">
                    {{ menu_str|raw }}
                </ol>
            </div>
            <div class="tab-pane fade show active" id="pills-recursos" role="tabpanel" aria-labelledby="pills-profile-tab">
                <h5 class="text-center my-3 color-light-grey font-normal ">{{ 'Recursos'|trans }}</h5>
                <a href="{{ path('_espacioColaborativo', { 'programa_id': programa.id, 'subpagina_id': subpagina_id }) }}">{{ 'Espacio colaborativo'|trans }}</a>
                <a href="">{{ 'Reportar problema'|trans }}</a>
            </div>
        </div>
    </div>
{% endblock %}

{% block bg %}
    bg-white
{% endblock %}

{% block body %}

    <input type="hidden" id="usuario_id" name="usuario_id" value="{{ app.session.get('usuario').id }}">
    <input type="hidden" id="programa_id" name="programa_id" value="{{ programa.id }}">
    <input type="hidden" id="url_save" name="url_save" value="{{ path('_ajaxSaveForo') }}">
    <input type="hidden" id="url_edit" name="url_edit" value="{{ path('_ajaxEditForo') }}">
    
    <section class="esp_col">
        <div class="row align-items-center justify-content-between">
            {% if app.session.get('usuario').tutor %}
                <div class="col-4 col-lg-4 col-xl-4 col-md-4 col-sm-4 col-xs-4 text-left">
                    <button class="btn btn-primary btn-nw-tema" data-toggle="modal" data-target="#modalnew">{{ 'Crear nuevo tema'|trans }}</button>
                </div>
            {% endif %}
            <div class="col-4 col-lg-4 col-xl-4 col-md-4 col-sm-4 col-xs-4">
                <input type="search" class="form-control" placeholder="Ingrese lo que desea buscar">
                <button type="button" class="btn-search"><span class="material-icons ic-search">search</span></button>
            </div>
        </div>
        <div class="row">
            <ul class="table-card">
                <a href="#">
                    <li class="f-table">
                        <div class="row justify-content-between">
                            <div class="col-6">
                                <h5 class="titulo_f-table">Tema abierto sobre el liderazgo</h5>
                            </div>
                            <div class="col-2">
                                <div class="status_f-table">
                                    <span class="status_ft">Destacado</span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-10">
                                <p class="txt-description">
                                    Aquí van las primeras lineas de este hilo Anything suspicious? Well... then should we go? Any uh... Cartel news these days? Seem …
                                </p>
                            </div>
                        </div>
                        <div class="row align-items-end foo-esp_col">
                            <div class="col-auto">
                                <span class="name_ft">Patricio Calamardo</span>
                            </div>
                            <div class="col-auto">
                                <span class="coment_f-table">Hizo un comentario: <span>Hace 3 min</span></span>
                            </div>
                            <div class="col-auto">
                                <span class="resp_ft"><i class="material-icons ic-msg">message</i> 20</span>
                            </div>
                        </div>
                    </li>
                </a>
                <a href="#">
                    <li class="f-table">
                        <div class="row justify-content-between">
                            <div class="col-6">
                                <h5 class="titulo_f-table">Tema abierto sobre el liderazgo</h5>
                            </div>
                            <div class="col-2">
                                <div class="status_f-table activar-destacado">
                                    <span class="status_ft">Destacado</span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-10">
                                <p class="txt-description">
                                    Aquí van las primeras lineas de este hilo Anything suspicious? Well... then should we go? Any uh... Cartel news these days? Seem …
                                </p>
                            </div>
                        </div>
                        <div class="row align-items-end foo-esp_col">
                            <div class="col-auto">
                                <span class="name_ft">Patricio Calamardo</span>
                            </div>
                            <div class="col-auto">
                                <span class="coment_f-table">Hizo un comentario: <span>Hace 3 min</span></span>
                            </div>
                            <div class="col-auto">
                                <span class="resp_ft"><i class="material-icons ic-msg">message</i> 20</span>
                            </div>
                        </div>
                    </li>
                </a>
                <a href="#">
                    <li class="f-table">
                        <div class="row justify-content-between">
                            <div class="col-6">
                                <h5 class="titulo_f-table">Tema abierto sobre el liderazgo</h5>
                            </div>
                            <div class="col-2">
                                <div class="status_f-table">
                                    <span class="status_ft">Destacado</span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-10">
                                <p class="txt-description">
                                    Aquí van las primeras lineas de este hilo Anything suspicious? Well... then should we go? Any uh... Cartel news these days? Seem …
                                </p>
                            </div>
                        </div>
                        <div class="row align-items-end foo-esp_col">
                            <div class="col-auto">
                                <span class="name_ft">Patricio Calamardo</span>
                            </div>
                            <div class="col-auto">
                                <span class="coment_f-table">Hizo un comentario: <span>Hace 3 min</span></span>
                            </div>
                            <div class="col-auto">
                                <span class="resp_ft"><i class="material-icons ic-msg">message</i> 20</span>
                            </div>
                        </div>
                    </li>
                </a>
                <a href="#">
                    <li class="f-table">
                        <div class="row justify-content-between">
                            <div class="col-6">
                                <h5 class="titulo_f-table">Tema abierto sobre el liderazgo</h5>
                            </div>
                            <div class="col-2">
                                <div class="status_f-table">
                                    <span class="status_ft">Destacado</span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-10">
                                <p class="txt-description">
                                    Aquí van las primeras lineas de este hilo Anything suspicious? Well... then should we go? Any uh... Cartel news these days? Seem …
                                </p>
                            </div>
                        </div>
                        <div class="row align-items-end foo-esp_col">
                            <div class="col-auto">
                                <span class="name_ft">Patricio Calamardo</span>
                            </div>
                            <div class="col-auto">
                                <span class="coment_f-table">Hizo un comentario: <span>Hace 3 min</span></span>
                            </div>
                            <div class="col-auto">
                                <span class="resp_ft"><i class="material-icons ic-msg">message</i> 20</span>
                            </div>
                        </div>
                    </li>
                </a>
                <a href="#">
                    <li class="f-table">
                        <div class="row justify-content-between">
                            <div class="col-6">
                                <h5 class="titulo_f-table">Tema abierto sobre el liderazgo</h5>
                            </div>
                            <div class="col-2">
                                <div class="status_f-table">
                                    <span class="status_ft">Destacado</span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-10">
                                <p class="txt-description">
                                    Aquí van las primeras lineas de este hilo Anything suspicious? Well... then should we go? Any uh... Cartel news these days? Seem …
                                </p>
                            </div>
                        </div>
                        <div class="row align-items-end foo-esp_col">
                            <div class="col-auto">
                                <span class="name_ft">Patricio Calamardo</span>
                            </div>
                            <div class="col-auto">
                                <span class="coment_f-table">Hizo un comentario: <span>Hace 3 min</span></span>
                            </div>
                            <div class="col-auto">
                                <span class="resp_ft"><i class="material-icons ic-msg">message</i> 20</span>
                            </div>
                        </div>
                    </li>
                </a>
                <a href="#">
                    <li class="f-table-lt">
                        <div class="row justify-content-between">
                            <div class="col-6">
                                <h5 class="titulo_f-table">Tema abierto sobre el liderazgo</h5>
                            </div>
                            <div class="col-2">
                                <div class="status_f-table">
                                    <span class="status_ft">Destacado</span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-10">
                                <p class="txt-description">
                                    Aquí van las primeras lineas de este hilo Anything suspicious? Well... then should we go? Any uh... Cartel news these days? Seem …
                                </p>
                            </div>
                        </div>
                        <div class="row align-items-end foo-esp_col">
                            <div class="col-auto">
                                <span class="name_ft">Patricio Calamardo</span>
                            </div>
                            <div class="col-auto">
                                <span class="coment_f-table">Hizo un comentario: <span>Hace 3 min</span></span>
                            </div>
                            <div class="col-auto">
                                <span class="resp_ft"><i class="material-icons ic-msg">message</i> 20</span>
                            </div>
                        </div>
                    </li>
                </a>
            </ul>
        </div>
        <div class="row align-items-center justify-content-center">
            <div class="col-auto 
                        col-lg-auto 
                        col-xl-auto 
                        col-md-auto 
                        col-sm-auto 
                        col-xs-auto 
                        px-0 pt-3">
                <nav aria-label="Page navigation example">
                    <ul class="pagination">
                        <li class="page-item"><a class="page-link" href="#">Anterior</a></li>
                        <li class="page-item"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item"><a class="page-link" href="#">Siguiente</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </section>
    <section>
        <div class="modal modal-edit" id="modalnew" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="container-fluid">
                <div class="row align-items-center justify-content-end">
                    <div class="col-auto">
                        <a class="close btn_close_modal" data-dismiss="modal" aria-label="Close">
                            <span class="material-icons ic-close-white" aria-hidden="true">close</span>
                        </a>
                    </div>
                </div>
                <div class="row mt-3 mb-2 align-items-center justify-content-center">
                    <div class="col-auto text-center">
                        <h4 class="titulo">Crear nuevo tema</h4>
                    </div>
                </div>
                <form action="">
                    <div class="row pl-3 align-items-center justify-content-center">
                        <div class="col-12">
                            <div class="form-group text-left">
                                <label class="mb-2 titulo-form" for="tema"> Titulo del tema: </label>
                                <input  type="text" class="form-control mb-4" id="tema" name="tema">
                            </div>
                        </div>
                    </div>
                    <div class="row pl-3 align-items-center justify-content-center">
                        <div class="form-group">
                            <div class="col-12">
                                <label class="mb-2 titulo-form" for="cont_tema"> Contenido del tema </label>
                                <textarea class="ckeditor" rows="3" id="edit" name="cont_tema" cols="30"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-3 align-items-center justify-content-end">
                        <div class="col-auto text-right">
                            <button type="submit" class="btn btn-primary">Publicar</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>

{% endblock %}

{% block comments %}

    <div id="comments" class="px-3 pt-3"  >
        <h5 class="color-grey text-center">{{ 'Comentarios'|trans }}</h5>
        <form class="mt-4 mb-6" id="form-comment" method="POST" action="{{ path('_ajaxEnviarComentario') }}">
            <div class="form-group">
                <textarea class="form-control" id="comentario" name="comentario" rows="3" maxlength="340" placeholder="{{ 'Escriba su comentario'|trans }}..."></textarea>
            </div>
            <button type="button" name="button" class="btn btn-sm btn-primary float-right" id="button-comment">{{ 'Comentar'|trans }}</button>
        </form>
        <div class="tab mt-6 d-flex justify-content-around text-xs ">
            <a href="#" class="active-line color-light-grey mt-3 tab_rv" id="mas_recientes">{{ 'Más recientes'|trans }}</a>
            <a href="#" class="color-light-grey mt-3 tab_rv" id="mas_valorados">{{ 'Más valorados'|trans }} </a>
        </div>

        {% if not wizard %}
            <input type="hidden" id="dirty_{{ lecciones.id }}" name="dirty_{{ lecciones.id }}" value="0">
            <div id="mas_recientes_comments-{{ lecciones.id }}">
                {% set total_comentarios = lecciones.muros_recientes.total_comentarios %}
                {% set total_muro = lecciones.muros_recientes.muros|length %}
                {% for muro in lecciones.muros_recientes.muros %}
                    {{ include('LinkFrontendBundle:Leccion:muro.html.twig', { 'muro': muro, 'prefix': 'recientes' }) }}
                {% endfor %}
                {% if total_comentarios > total_muro %}
                    <input type="hidden" id="more_comments_recientes-{{ lecciones.id }}" name="more_comments_recientes-{{ lecciones.id }}" value="0">
                    <a href="#" class="links text-center d-block more_comments" data="{{ lecciones.id }}">{{ 'Ver más comentarios'|trans }}</a>
                {% endif %}
            </div>
            <div id="mas_valorados_comments-{{ lecciones.id }}" style="display:none;">
                {% set total_comentarios = lecciones.muros_valorados.total_comentarios %}
                {% set total_muro = lecciones.muros_valorados.muros|length %}
                {% for muro in lecciones.muros_valorados.muros %}
                    {{ include('LinkFrontendBundle:Leccion:muro.html.twig', { 'muro': muro, 'prefix': 'valorados' }) }}
                {% endfor %}
                {% if total_comentarios > total_muro %}
                    <input type="hidden" id="more_comments_valorados-{{ lecciones.id }}" name="more_comments_valorados-{{ lecciones.id }}" value="0">
                    <a href="#" class="links text-center d-block more_comments" data="{{ lecciones.id }}">{{ 'Ver más comentarios'|trans }}</a>
                {% endif %}
            </div>
        {% else %}
            {% for subpagina in lecciones.subpaginas %}
                <input type="hidden" id="dirty_{{ subpagina.id }}" name="dirty_{{ subpagina.id }}" value="0">
                <div id="mas_recientes_comments-{{ subpagina.id }}" {{ loop.index==1 ? '' : 'style="display:none;"' }}>
                    {% set total_comentarios = subpagina.muros_recientes.total_comentarios %}
                    {% set total_muro = subpagina.muros_recientes.muros|length %}
                    {% for muro in subpagina.muros_recientes.muros %}
                        {{ include('LinkFrontendBundle:Leccion:muro.html.twig', { 'muro': muro, 'prefix': 'recientes' }) }}
                    {% endfor %}
                    {% if total_comentarios > total_muro %}
                        <input type="hidden" id="more_comments_recientes-{{ subpagina.id }}" name="more_comments_recientes-{{ subpagina.id }}" value="0">
                        <a href="#" class="links text-center d-block more_comments" data="{{ subpagina.id }}">{{ 'Ver más comentarios'|trans }}</a>
                    {% endif %}
                </div>
                <div id="mas_valorados_comments-{{ subpagina.id }}" style="display:none;">
                    {% set total_comentarios = subpagina.muros_valorados.total_comentarios %}
                    {% set total_muro = subpagina.muros_valorados.muros|length %}
                    {% for muro in subpagina.muros_valorados.muros %}
                        {{ include('LinkFrontendBundle:Leccion:muro.html.twig', { 'muro': muro, 'prefix': 'valorados' }) }}
                    {% endfor %}
                    {% if total_comentarios > total_muro %}
                        <input type="hidden" id="more_comments_valorados-{{ subpagina.id }}" name="more_comments_valorados-{{ subpagina.id }}" value="0">
                        <a href="#" class="links text-center d-block more_comments" data="{{ subpagina.id }}">{{ 'Ver más comentarios'|trans }}</a>
                    {% endif %}
                </div>
            {% endfor %}
        {% endif %}

    </div>

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('front/js/popper.min.js') }}" charset="utf-8"></script>
    <script src="{{ asset('front/js/jquery.scrollTo.min.js') }}" charset="utf-8"></script>
    <script src="{{ asset('front/js/navLecciones.js') }}"></script>
    <script type="text/javascript" src="{{ asset('js/front/lecciones.js') }}"></script>
{% endblock %}